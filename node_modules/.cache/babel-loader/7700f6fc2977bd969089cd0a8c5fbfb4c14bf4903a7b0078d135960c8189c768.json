{"ast":null,"code":"import _objectSpread from\"D:/site/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/site/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import{useEffect}from\"react\";import classes from\"../styles/Login.module.css\";import MyButton from\"./UI/button/mybutton.jsx\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(_ref){var L=_ref.L,SL=_ref.SL,AccessAllowed=_ref.AccessAllowed,AccessRestricted=_ref.AccessRestricted,onLogin=_ref.onLogin,isOpen=_ref.isOpen,onClose=_ref.onClose;var _useState=useState({login:'',password:''}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],SetuserData=_useState2[1];useEffect(function(){SetuserData(JSON.parse(localStorage.getItem('lastuser:')));},[]);useEffect(function(){localStorage.setItem('boollog:',JSON.stringify(L));},[L]);if(!isOpen)return null;var HandleLogin=function HandleLogin(UserData){var flag=0;var ValidLogin=0;if(UserData.login.length<5)alert(\"Логин должен быть не меньше 5 символов\");else if(UserData.password.length<8)alert(\"Пароль должен быть не меньше 8 символов\");else ValidLogin=1;for(var i=0;i<localStorage.length&&ValidLogin;i++){var key=localStorage.key(i);// Получаем ключ очередного элемента\nif(key.startsWith('{\"login\":')){try{var _userData=JSON.parse(key);if(_userData.login===UserData.login){if(_userData.password===UserData.password){SL(true);onLogin(_userData);AccessAllowed(_userData);localStorage.setItem('lastuser:',JSON.stringify(UserData));onClose();}else AccessRestricted();flag=1;}}catch(error){console.error('Ошибка при разборе данных:',error);}}}if(!flag&&ValidLogin){SL(true);onLogin(userData);AccessAllowed(userData);localStorage.setItem('lastuser:',JSON.stringify(UserData));localStorage.setItem(JSON.stringify(userData),[]);onClose();}};var LogOut=function LogOut(){SL(false);SetuserData({login:'',password:''});// меняем на дефолтного\nlocalStorage.setItem('lastuser:',JSON.stringify({login:'',password:''}));localStorage.setItem(JSON.stringify({login:'',password:''}),[]);// удаляем посты\nonLogin({login:'',password:''});AccessAllowed({login:'',password:''});};return/*#__PURE__*/_jsxs(\"div\",{className:classes.login,children:[/*#__PURE__*/_jsx(\"h3\",{style:{fontFamily:'cursive',textAlign:'center',marginBottom:10,fontSize:24},children:\"\\u0412\\u0445\\u043E\\u0434 \\u0438 \\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"input\",{className:classes.InputLogin,style:{marginLeft:80},disabled:L,type:\"text\",placeholder:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",value:userData.login,onChange:function onChange(e){return SetuserData(_objectSpread(_objectSpread({},userData),{},{login:e.target.value}));}}),/*#__PURE__*/_jsx(\"input\",{className:classes.InputLogin,disabled:L,type:\"text\",placeholder:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",value:userData.password,onChange:function onChange(e){return SetuserData(_objectSpread(_objectSpread({},userData),{},{password:e.target.value}));}}),L?/*#__PURE__*/_jsx(MyButton,{onClick:function onClick(){LogOut();},children:\"\\u0412\\u044B\\u0445\\u043E\\u0434\"}):/*#__PURE__*/_jsx(MyButton,{onClick:function onClick(){HandleLogin(userData);},children:\"\\u0412\\u0445\\u043E\\u0434\"})]});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","classes","MyButton","jsx","_jsx","jsxs","_jsxs","Login","_ref","L","SL","AccessAllowed","AccessRestricted","onLogin","isOpen","onClose","_useState","login","password","_useState2","_slicedToArray","userData","SetuserData","JSON","parse","localStorage","getItem","setItem","stringify","HandleLogin","UserData","flag","ValidLogin","length","alert","i","key","startsWith","error","console","LogOut","className","children","style","fontFamily","textAlign","marginBottom","fontSize","InputLogin","marginLeft","disabled","type","placeholder","value","onChange","e","_objectSpread","target","onClick"],"sources":["D:/site/src/components/Login.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport classes from \"../styles/Login.module.css\"\r\nimport MyButton from \"./UI/button/mybutton.jsx\"\r\n\r\nconst Login = ({ L, SL, AccessAllowed, AccessRestricted, onLogin, isOpen, onClose }) => {\r\n\r\n    const [userData, SetuserData] = useState({ login: '', password: '' });\r\n\r\n    useEffect(() => {\r\n        SetuserData(JSON.parse(localStorage.getItem('lastuser:')));\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('boollog:', JSON.stringify(L));\r\n    }, [L]);\r\n\r\n    if(!isOpen)\r\n        return null;\r\n\r\n    const HandleLogin = (UserData) => {\r\n        let flag = 0;\r\n        let ValidLogin = 0;\r\n\r\n        if (UserData.login.length < 5)\r\n            alert(\"Логин должен быть не меньше 5 символов\");\r\n        else if (UserData.password.length < 8)\r\n            alert(\"Пароль должен быть не меньше 8 символов\")\r\n        else\r\n            ValidLogin = 1;\r\n\r\n        for (let i = 0; i < localStorage.length && ValidLogin; i++) {\r\n            const key = localStorage.key(i); // Получаем ключ очередного элемента\r\n\r\n            if (key.startsWith('{\"login\":')) {\r\n                try {\r\n                    const userData = JSON.parse(key);\r\n                    if (userData.login === UserData.login) {\r\n                        if (userData.password === UserData.password) {\r\n                            SL(true);\r\n\r\n                            onLogin(userData);\r\n                            AccessAllowed(userData);\r\n\r\n                            localStorage.setItem('lastuser:', JSON.stringify(UserData));\r\n                            onClose();\r\n                        }\r\n                        else\r\n                            AccessRestricted();\r\n                        flag = 1;\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    console.error('Ошибка при разборе данных:', error);\r\n                }\r\n            }\r\n        }\r\n        if (!flag && ValidLogin) {\r\n            SL(true);\r\n\r\n            onLogin(userData);\r\n            AccessAllowed(userData);\r\n\r\n            localStorage.setItem('lastuser:', JSON.stringify(UserData));\r\n            localStorage.setItem(JSON.stringify(userData), []);\r\n\r\n            onClose();\r\n        }\r\n    }\r\n\r\n    const LogOut = () => {\r\n        SL(false);\r\n        SetuserData({ login: '', password: '' }); // меняем на дефолтного\r\n\r\n        localStorage.setItem('lastuser:', JSON.stringify({ login: '', password: '' }));\r\n        localStorage.setItem(JSON.stringify({ login: '', password: '' }), []); // удаляем посты\r\n\r\n        onLogin({ login: '', password: '' });\r\n        AccessAllowed({ login: '', password: '' });\r\n    }\r\n\r\n    return (\r\n        <div className={classes.login}>\r\n            <h3 style={{\r\n                fontFamily: 'cursive',\r\n                textAlign: 'center',\r\n                marginBottom: 10,\r\n                fontSize: 24\r\n            }}>Вход и регистрация\r\n            </h3>\r\n            <input\r\n                className={classes.InputLogin}\r\n                style={{ marginLeft: 80 }}\r\n                disabled={L}\r\n                type=\"text\"\r\n                placeholder='Имя пользователя'\r\n                value={userData.login}\r\n                onChange={e => SetuserData({ ...userData, login: e.target.value })}\r\n            />\r\n            <input\r\n                className={classes.InputLogin}\r\n                disabled={L}\r\n                type=\"text\"\r\n                placeholder='Пароль'\r\n                value={userData.password}\r\n                onChange={e => SetuserData({ ...userData, password: e.target.value })}\r\n            />\r\n            {   \r\n                L ?\r\n                    <MyButton onClick={() => { LogOut() }}>Выход</MyButton>\r\n                    :\r\n                    <MyButton onClick={() => { HandleLogin(userData) }}>Вход</MyButton>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}